<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MADARA ALPA - Complete Fix</title>
    
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --light-purple: #e0d7f7; 
            --deep-purple: #6e48aa;
            --primary-purple: #9d81e1;
        }

        body {
            font-family: 'El Messiri', sans-serif;
            margin: 0; padding: 0;
            background-color: var(--light-purple); 
            display: flex; justify-content: center;
            overflow-x: hidden;
        }

        .app-container {
            width: 100%; max-width: 420px;
            min-height: 100vh;
            padding: 10px 0;
            box-sizing: border-box;
            text-align: center;
        }

        /* HEADER SECTION (CROWN + TITLE) */
        .header-section {
            display: flex; align-items: center; justify-content: center;
            padding: 10px; width: 100%; box-sizing: border-box;
        }

        .left-crown {
            width: 35px; height: 35px; fill: var(--deep-purple); margin-right: 8px; flex-shrink: 0;
        }

        .animated-title {
            font-size: 32px; font-weight: 700; fill: transparent; stroke: var(--deep-purple);
            stroke-width: 1.2px; stroke-dasharray: 600; stroke-dashoffset: 600;
            animation: textDrawing 5s infinite alternate ease-in-out;
        }

        @keyframes textDrawing {
            0% { stroke-dashoffset: 600; fill: transparent; }
            100% { stroke-dashoffset: 0; fill: var(--deep-purple); }
        }
        
        /* LOGO */
        .logo-box {
            width: 80px; height: 80px; border-radius: 50%;
            display: block; margin: 10px auto;
            border: 3px solid var(--primary-purple);
            background: url('https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000455306.jpg?alt=media') center/cover;
        }

        /* MODS HIGHLIGHTED BOX */
        .mods-highlight-box {
            background: linear-gradient(135deg, rgba(110, 72, 170, 0.2), rgba(157, 129, 225, 0.3));
            margin: 10px 20px;
            padding: 12px;
            border-radius: 15px;
            border: 2px solid var(--deep-purple);
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 0 15px rgba(110, 72, 170, 0.3);
        }

        .mods-left-group {
            display: flex; align-items: center; gap: 8px;
        }

        .calendar-icon {
            width: 22px; height: 22px; fill: var(--deep-purple);
        }

        .mods-text {
            font-weight: 800; color: var(--deep-purple); font-size: 16px; letter-spacing: 1px;
        }

        #mode-select {
            border: 1px solid var(--primary-purple); background: white; 
            border-radius: 8px; padding: 2px 5px; font-weight: bold; 
            color: var(--deep-purple); outline: none; font-family: 'El Messiri';
        }

        #timer { font-weight: bold; color: var(--deep-purple); font-size: 18px; }

        /* BOLLS & SNAKE ANIMATION */
        .wheel-container {
            display: flex; justify-content: center; gap: 12px;
            padding: 20px 10px; flex-wrap: wrap;
        }

        .multiplier-box {
            width: 65px; height: 65px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-family: Arial, sans-serif; font-weight: 900; font-size: 16px; 
            color: var(--light-purple);
            background: url('https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000481647.png?alt=media&token=a53e5597-013b-49d0-9685-207b500803b0') center/cover;
            border: none; transition: 0.2s ease;
            text-shadow: 1px 1px 3px #000;
        }

        /* Snake Running Highlight */
        .snake-active {
            box-shadow: 0 0 20px 5px #fff;
            filter: brightness(1.5);
            transform: scale(1.1);
        }

        .multiplier-box.result {
            background-size: 100% 100% !important;
            transform: scale(1.4);
            box-shadow: 0 0 30px 10px rgba(157, 129, 225, 0.9);
            z-index: 10;
        }

        .result-btn {
            width: 85%; padding: 18px; margin: 20px auto; display: block;
            background: linear-gradient(135deg, var(--deep-purple), var(--primary-purple));
            border: none; border-radius: 35px; color: #fff;
            font-family: 'El Messiri', sans-serif; font-size: 20px; font-weight: 800;
            cursor: pointer; box-shadow: 0 5px 15px rgba(110, 72, 170, 0.4);
        }

        .winners-box {
            margin: 15px; background: rgba(255, 255, 255, 0.4);
            border-radius: 15px; height: 160px; overflow: hidden;
            padding: 10px; border: 1px solid var(--primary-purple);
        }

        .winner-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 8px 5px; border-bottom: 1px solid rgba(0,0,0,0.05); font-size: 13px;
        }

        .w-avatar { 
            width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; 
            border: 1px solid var(--primary-purple);
            background: url('https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000455311.jpg?alt=media') center/cover;
        }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="header-section">
            <svg class="left-crown" viewBox="0 0 24 24"><path d="M5,16L3,5L8.5,10L12,4L15.5,10L21,5L19,16H5M19,19C19,19.6 18.6,20 18,20H6C5.4,20 5,19.6 5,19V18H19V19Z" /></svg>
            <div class="title-svg-container">
                <svg width="240" height="50"><text x="50%" y="75%" text-anchor="middle" class="animated-title">MADARA ALPA</text></svg>
            </div>
        </div>

        <div class="logo-box"></div>

        <div class="mods-highlight-box">
            <div class="mods-left-group">
                <svg class="calendar-icon" viewBox="0 0 24 24"><path d="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.9 20.1,3 19,3H18V1M17,12H12V17H17V12Z" /></svg>
                <span class="mods-text">MODS :-</span>
                <select id="mode-select" onchange="resetWheel()">
                    <option value="easy">EASY</option>
                    <option value="medium">MEDIUM</option>
                    <option value="hard">HARD</option>
                </select>
            </div>
            <div id="timer">00:30</div>
        </div>

        <div class="wheel-container" id="multiplier-wheel"></div>

        <button class="result-btn" onclick="startSpin()">GENERATE RESULT</button>

        <div class="winners-box" id="winners-feed"></div>
    </div>

    <script>
        const wheel = document.getElementById('multiplier-wheel');
        const feed = document.getElementById('winners-feed');
        const modeSel = document.getElementById('mode-select');
        const resultBtn = document.querySelector('.result-btn');

        const predImages = [
            "https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000483404.png?alt=media&token=152edf98-d68f-4156-a3ad-4f1ef47db72d",
            "https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000483405.png?alt=media&token=62cc3681-29b8-4502-b057-69a62c2180f9",
            "https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000483406.png?alt=media&token=f321be49-b74d-49e5-b8bf-88bd01594080",
            "https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000483407.png?alt=media&token=f658c7b0-539f-49fa-a224-85e0e61f3ec8",
            "https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000483408.png?alt=media&token=10ae2537-f432-4a3d-95b8-9e78b9bd3996",
            "https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000483409.png?alt=media&token=a29f3c42-9837-485c-bcb1-be9c1a6034fe",
            "https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000483410.png?alt=media&token=43a20b3b-ebde-4af1-8a56-b6044a597832"
        ];

        // PRELOAD IMAGES INSTANTLY
        predImages.forEach(src => { const img = new Image(); img.src = src; });

        const multipliers = {
            easy: ["1.20", "1.10", "1.50", "1.30", "1.15", "1.05", "1.80", "2.00"],
            medium: ["2.50", "3.10", "1.80", "4.00", "5.20", "2.10", "3.50", "1.90"],
            hard: ["10.0", "15.5", "5.50", "25.0", "50.0", "8.40", "12.0", "2.10"]
        };

        function resetWheel() {
            wheel.innerHTML = '';
            multipliers[modeSel.value.toLowerCase()].forEach(m => {
                const b = document.createElement('div');
                b.className = 'multiplier-box';
                b.dataset.val = m;
                wheel.appendChild(b);
            });
        }

        function startSpin() {
            resultBtn.disabled = true;
            resultBtn.textContent = 'ANALYZING...';
            const boxes = document.querySelectorAll('.multiplier-box');
            boxes.forEach(b => { 
                b.textContent = ''; b.classList.remove('result', 'snake-active'); 
                b.style.backgroundImage = 'url("https://firebasestorage.googleapis.com/v0/b/i-to-u.appspot.com/o/publicimage%2F1000481647.png?alt=media&token=a53e5597-013b-49d0-9685-207b500803b0")';
            });

            let count = 0, idx = 0, target = Math.floor(Math.random() * boxes.length);
            
            // Snake Running Logic
            const spin = setInterval(() => {
                boxes.forEach(b => b.classList.remove('snake-active'));
                boxes[idx].classList.add('snake-active');
                idx = (idx + 1) % boxes.length;
                
                if (count++ > 20) {
                    clearInterval(spin);
                    boxes.forEach(b => b.classList.remove('snake-active'));
                    // Instant Result
                    boxes[target].classList.add('result');
                    const img = predImages[Math.floor(Math.random() * predImages.length)];
                    boxes[target].style.backgroundImage = `url('${img}')`;
                    boxes[target].textContent = boxes[target].dataset.val + 'x';
                    resultBtn.disabled = false;
                    resultBtn.textContent = 'GENERATE RESULT';
                }
            }, 60);
        }

        function addWinner() {
            const names = ["Zayan", "Arish", "Kabir", "Mehak", "Irfan"];
            const row = document.createElement('div');
            row.className = 'winner-row';
            row.innerHTML = `<div style="display:flex; align-items:center;"><div class="w-avatar"></div>${names[Math.floor(Math.random()*5)]}</div><div style="color:#27ae60; font-weight:bold;">+â‚¹${(Math.random()*400).toFixed(2)}</div>`;
            feed.prepend(row);
            if(feed.children.length > 5) feed.lastChild.remove();
        }

        setInterval(addWinner, 2500);
        setInterval(() => {
            let s = 30 - (new Date().getSeconds() % 30);
            document.getElementById('timer').textContent = "00:" + (s < 10 ? "0" + s : s);
        }, 1000);

        window.onload = resetWheel;
    </script>
</body>
</html>
